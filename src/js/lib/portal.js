!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.portal={})}(this,function(e){"use strict";function t(e,n){var r=[];for(var i in e)if(e.hasOwnProperty(i)){var o=n?n+"["+i+"]":i,s=e[i];r.push("object"==(void 0===s?"undefined":x(s))?t(s,o):encodeURIComponent(o)+"="+encodeURIComponent(s))}return r.join("&")}function n(e,t){var n=this,r=n.portalUrl+"sharing/rest/generateToken",i={client:"referer",referer:window.location.hostname,expiration:60,username:e,password:t,f:"json"},o={withCredentials:n.withCredentials};return D.post(r,i,o)}function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=this,o=i.portalUrl+"sharing/rest/search",s={q:e,num:t,sortField:n,sortOrder:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return D.get(o,s,a)}function i(){var e=this,t=e.portalUrl+"sharing/rest/portals/self",n={token:e.token,f:"json"},r={withCredentials:e.withCredentials};return D.get(t,n,r)}function o(){var e=this,t=e.portalUrl+"sharing/rest",n={f:"json"},r={withCredentials:e.withCredentials};return D.get(t,n,r)}function s(e,t){var n=this,r=n.portalUrl+"sharing/rest/content/users/"+e+"/"+t,i={token:n.token,f:"json"},o={withCredentials:n.withCredentials};return D.get(r,i,o)}function a(e){var t=this,n=t.portalUrl+"sharing/rest/community/users/"+e,r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return D.get(n,r,i)}function c(e,t,n,r,i){var o=this,s=o.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/addItem";for(var a in n)null===n[a]?n[a]="":n[a]instanceof Array&&(n[a]=n[a].toString());var c={item:n.title,overwrite:!1,thumbnailurl:i,token:o.token,f:"json"};"object"===(void 0===r?"undefined":x(r))&&null!==r?c.text=JSON.stringify(r):c.text="",Object.assign(c,n);var l={withCredentials:o.withCredentials};return D.post(s,c,l)}function l(e){var t=this,n=t.portalUrl+"sharing/rest/content/items/"+e+"/data",r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return D.get(n,r,i)}function u(e){var t=this,n=t.portalUrl+"sharing/rest/content/items/"+e,r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return D.get(n,r,i)}function h(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+n+"/items/"+t+"/update",s={text:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return D.post(o,s,a)}function d(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+n+"/items/"+t+"/update",s=JSON.parse(r),a=!0,c=!1,l=void 0;try{for(var u,h=Object.keys(s)[Symbol.iterator]();!(a=(u=h.next()).done);a=!0){var d=u.value,p=s[d];null===p?s[d]="":p instanceof Array&&(s[d]=p.toString())}}catch(e){c=!0,l=e}finally{try{!a&&h.return&&h.return()}finally{if(c)throw l}}s.token=i.token,s.f="json";var f={withCredentials:i.withCredentials};return D.post(o,s,f)}function p(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/items/"+n+"/update",s={url:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return D.post(o,s,a)}function f(e,t,n,r){var i=this,o=i.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/items/"+n+"/update",s={text:JSON.stringify(r),token:i.token,f:"json"},a={withCredentials:i.withCredentials};return D.post(o,s,a)}function y(e){var t=this,n=t.portalUrl+"sharing/rest/content/items/"+e+"/dependencies/listDependentsTo",r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return D.get(n,r,i)}function v(e,t,n){var r=this,i=e+"/"+t+"/addFeatures",o={features:n,token:r.token,f:"json"},s={withCredentials:r.withCredentials};return D.post(i,o,s)}function w(e,t){var n=this,r=(e=e.replace("/rest/services/","/rest/admin/services/"))+"/addToDefinition",i={addToDefinition:t,token:n.token,f:"json"},o={withCredentials:n.withCredentials};return D.post(r,i,o)}function m(e){this.items.push({id:e.id,description:e})}function C(e,t,n){var r=this,i=r.portalUrl+"sharing/rest/portals/"+e+"/isServiceNameAvailable",o={name:t,type:n,token:r.token,f:"json"},s={withCredentials:r.withCredentials};return D.get(i,o,s)}function g(e,t,n){var r=this,i=r.portalUrl+"sharing/rest/content/users/"+e+"/"+t+"/createService",o={createParameters:n,outputType:"featureService",token:r.token,f:"json"},s={withCredentials:r.withCredentials};return D.post(i,o,s)}function k(e,t,n,r){var i=this,o=e+"/"+t+"/query",s={where:"1=1",outFields:"*",returnGeometry:!0,resultOffset:n,resultRecordCount:r,token:i.token,f:"json"},a={withCredentials:i.withCredentials};return D.get(o,s,a)}function S(e,t){var n=this,r=e+"/"+t+"/query",i={where:"1=1",returnCountOnly:!0,token:n.token,f:"json"},o={withCredentials:n.withCredentials};return D.get(r,i,o)}function b(e){var t=this,n=e,r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return D.get(n,r,i)}function j(e){var t=this,n=e+"/layers",r={token:t.token,f:"json"},i={withCredentials:t.withCredentials};return D.get(n,r,i)}function U(e){var t=E.filter(function(t){return t.type===e})[0];return t=void 0!==t?t:{icon:"datafilesGray"}}var x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O=(function(){function e(e){this.value=e}function t(t){function n(i,o){try{var s=t[i](o),a=s.value;a instanceof e?Promise.resolve(a.value).then(function(e){n("next",e)},function(e){n("throw",e)}):r(s.done?"return":"normal",s.value)}catch(e){r("throw",e)}}function r(e,t){switch(e){case"return":i.resolve({value:t,done:!0});break;case"throw":i.reject(t);break;default:i.resolve({value:t,done:!1})}(i=i.next)?n(i.key,i.arg):o=null}var i,o;this._invoke=function(e,t){return new Promise(function(r,s){var a={key:e,arg:t,resolve:r,reject:s,next:null};o?o=o.next=a:(i=o=a,n(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),D={get:function(e,n,r){return r=void 0!==r?r:{withCredentials:!1},new Promise(function(i,o){var s=new XMLHttpRequest;s.withCredentials=r.withCredentials,s.addEventListener("readystatechange",function(){if(4===s.readyState&&200==s.status){var e=void 0;e=""===s.response?null:JSON.parse(s.response),i(e)}else 4===s.readyState&&500==s.status&&o(Error(s))}),s.addEventListener("error",function(){o(Error(s))}),s.open("GET",e+"?"+t(n)),s.timeout=12e4,s.ontimeout=function(){console.log("timeout"),o(Error(s))},s.send()})},post:function(e,n,r){return r=void 0!==r?r:{withCredentials:!1},new Promise(function(i,o){var s=new XMLHttpRequest;s.withCredentials=r.withCredentials,s.addEventListener("readystatechange",function(){if(4===s.readyState&&200==s.status){var e=void 0;e=""===s.response?null:JSON.parse(s.response),i(e)}else 4===s.readyState&&500==s.status&&o(Error(s))}),s.addEventListener("error",function(){o(Error(s))}),s.open("POST",e),s.timeout=12e4,s.ontimeout=function(){console.log("timeout"),o(Error(s))},s.setRequestHeader("content-type","application/x-www-form-urlencoded"),s.send(t(n))})}},E=[{type:"CityEngine Web Scene",icon:"webScene"},{type:"Color Set",icon:"datafilesGray"},{type:"Document Link",icon:"datafilesGray"},{type:"Image Service",icon:"imagery"},{type:"Feature Collection",icon:"features"},{type:"Feature Collection Template",icon:"maps"},{type:"Feature Layer",icon:"features"},{type:"Feature Service",icon:"features"},{type:"Geocoding Service",icon:"layers"},{type:"Geodata Service",icon:"layers"},{type:"Geometry Service",icon:"layers"},{type:"Geoprocessing Service",icon:"layers"},{type:"Globe Service",icon:"layers"},{type:"Network Analysis Service",icon:"layers"},{type:"Map Service",icon:"layers"},{type:"Mobile Application",icon:"apps"},{type:"Operation View",icon:"apps"},{type:"Scene Layer",icon:"sceneLayer"},{type:"Scene Service",icon:"sceneLayer"},{type:"Service Definition",icon:"datafiles"},{type:"Symbol Set",icon:"datafiles"},{type:"Web Map",icon:"maps"},{type:"Web Mapping Application",icon:"apps"},{type:"Web Scene",icon:"webScene"},{type:"WMS",icon:"layers"}],L=Object.freeze({fixUrl:function(e){return new Promise(function(t){""===e?e="https://www.arcgis.com/":e.search("/home/")>0?e=e.substr(0,e.search("/home"))+"/":e.search("/sharing")>0?e=e.substr(0,e.search("/sharing"))+"/":"/"!==e.charAt(e.length-1)&&(e+="/"),0===e.indexOf("http://")&&0===window.location.href.indexOf("https://")&&(e=e.replace("http://","https://")),t(e)})},upgradeUrl:function(e){return 0===e.indexOf("http://")&&0===window.location.href.indexOf("https://")&&(e=e.replace("http://","https://")),e}});e.Portal=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},U=t.portalUrl,x=void 0===U?"https://www.arcgis.com":U,D=t.username,E=void 0===D?"":D,L=t.token,T=void 0===L?"":L,P=t.withCredentials,G=void 0!==P&&P;O(this,e),this.portalUrl=x,this.username=E,this.token=T,this.withCredentials=G,this.items=[],this.services=[],this.generateToken=n,this.search=r,this.self=i,this.version=o,this.userContent=s,this.userProfile=a,this.itemDescription=u,this.itemData=l,this.addItem=c,this.updateWebmapData=f,this.updateDescription=d,this.updateData=h,this.updateUrl=p,this.itemDependentsTo=y,this.serviceDescription=b,this.serviceLayers=j,this.layerRecordCount=S,this.createService=g,this.addToServiceDefinition=w,this.checkServiceName=C,this.harvestRecords=k,this.addFeatures=v,this.cacheItem=m},e.itemInfo=function(e){return U(e)},e.util=L,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=portal.js.map
